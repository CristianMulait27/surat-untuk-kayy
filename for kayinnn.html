<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surat untuk Kayy</title>
  <style>
    :root{--bg:#ffebf6;--card:#fff;--accent:#ff4d88;--muted:#6b6b6b}
    *{box-sizing:border-box}
    body{margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#ffebf6,#ffe1ed,#fff);min-height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#ff4d88,#ff9fcf);display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:999;transition:opacity 1s ease}
    .overlay h1{color:#fff;font-size:34px;text-align:center;animation:fadeInDown 2s ease}
    .overlay p{color:#fff;font-size:18px;margin-top:12px;text-align:center;animation:fadeInUp 2.2s ease}
    .overlay button{margin-top:24px;padding:14px 28px;background:#fff;color:#ff4d88;font-weight:600;border:none;border-radius:30px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.2);transition:.3s}
    .overlay button:hover{transform:scale(1.05)}
    @keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}

    .card{width:100%;max-width:760px;background:var(--card);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.12);overflow:hidden;position:relative;z-index:1;opacity:0;transform:scale(.9);transition:all 1s ease}
    .card.show{opacity:1;transform:scale(1)}

    header{padding:28px 32px;background:linear-gradient(90deg,#fff 0%,#ffeef6 100%);display:flex;align-items:center;gap:16px}
    .avatar{width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--accent),#ff9fcf);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:20px}
    h1{margin:0;font-size:20px}
    p.sub{margin:0;color:var(--muted);font-size:13px}
    main{padding:28px 32px;display:flex;gap:24px;align-items:flex-start}
    .letter{flex:1;background:#fff;padding:22px;border-radius:12px;border:1px solid rgba(0,0,0,.04)}
    .letter p{margin:0 0 12px 0;line-height:1.5;color:#222}
    .message-box{font-family: 'Georgia', serif;background:#fff6fb;border-radius:10px;padding:18px;border:1px dashed rgba(255,94,149,.18);}
    .controls{width:240px}
    .btn{display:inline-block;padding:12px 18px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
    .accept{background:linear-gradient(90deg,var(--accent),#ff7fb0);color:#fff;width:100%;margin-bottom:12px}
    .reject{background:#f3f3f3;color:#333;width:100%}
    .small{font-size:13px;color:var(--muted);margin-top:8px}
    .result{margin-top:14px;padding:12px;border-radius:10px;background:#fff8f9;border:1px solid rgba(255,94,149,.06);display:none}
    .heart{font-size:40px;opacity:0;transform:translateY(10px) scale(.7);transition:all .6s cubic-bezier(.2,.9,.3,1)}
    .heart.show{opacity:1;transform:translateY(0) scale(1)}
    .reply-area{display:none;margin-top:12px}
    textarea{width:100%;min-height:96px;padding:12px;border-radius:10px;border:1px solid #eee;resize:vertical}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .whatsapp{background:#25d366;color:#fff;}
    footer{padding:14px 20px;background:linear-gradient(90deg,#fff,#fff0f6);font-size:13px;color:var(--muted);text-align:center}
    @media (max-width:720px){main{flex-direction:column}.controls{width:100%}}
  </style>
</head>
<body>
  <div class="overlay" id="overlay">
    <h1>üíå Hai Kayy</h1>
    <p>Ada sesuatu yang spesial untukmu dari Epen...</p>
    <button onclick="enterSite()">Buka Surat</button>
  </div>

  <div class="card" role="region" aria-label="Surat untuk Kayy" id="mainCard">
    <header>
      <div class="avatar">E</div>
      <div>
        <h1>Surat dari Epen untuk Kayy</h1>
        <p class="sub">Tampilkan perasaanmu dengan lembut ‚Äî kirim/terima/atau tolak secara langsung di halaman ini.</p>
      </div>
    </header>

    <main>
      <section class="letter" aria-live="polite">
        <div class="message-box">
          <p><strong>Isi pesan:</strong></p>
          <p id="originalMessage">Kayy, kayanya Epen so jatuh cinta skli sma kayy, semakin lama epen dkt dnk kayy semakin nyaman, epen nda pernah jatuh cinta sebesar ini epen, so angap kayy tempat ternyaman. sebenarnya dri malam epen so ovt sklii tentang kay mo trima ato tolak, klo mmng kay mo tolak npp noh epen maklumi kayy mungkin msi belum bisa trima orang baru mar klo kayy trima epen janji nd mo kse bersaing kay dng perempuan manapun, dng epen pe sayang nd akan habiss, mar jangan kay trima karna kasian neh. klo kay trima, epen cuma minta kay pe waktu dng rasa sayang tp klo kay tolak epen so nd mo ba ganggu pa kay leüòÑ</p>
        </div>
        <div class="small">Catatan: pesan ini ditulis persis seperti yang Anda berikan.</div>
      </section>

      <aside class="controls">
        <button class="btn accept" id="btnAccept">TERIMA</button>
        <button class="btn reject" id="btnReject">TOLAK</button>
        <div class="small">Jika penerima memilih <strong>TERIMA</strong>, akan muncul konfirmasi manis. Jika <strong>TOLAK</strong>, akan muncul pesan sopan agar tidak terganggu.</div>
        <div class="result" id="resultBox" aria-hidden="true">
          <div class="heart" id="heart">‚ù§Ô∏è</div>
          <div id="resultText"></div>
          <div class="reply-area" id="replyArea">
            <p class="small">Tulis jawabanmu (opsional):</p>
            <textarea id="replyText" placeholder="Tulis jawaban singkat..."></textarea>
            <div style="margin-top:8px" class="row">
              <button class="btn accept" id="sendReply">KIRIM JAWABAN</button>
              <button class="btn reject" id="cancelReply">BATAL</button>
              <button class="btn whatsapp" id="shareWhatsapp">Bagikan ke WhatsApp</button>
            </div>
          </div>
        </div>
      </aside>
    </main>

    <footer>Halaman sederhana ini dibuat untuk menyampaikan perasaan secara manis dan aman. Gunakan dengan bijak üíå</footer>
  </div>

  <script>
    function enterSite(){
      document.getElementById('overlay').style.opacity='0'
      setTimeout(()=>{
        document.getElementById('overlay').style.display='none'
        document.getElementById('mainCard').classList.add('show')
      },1000)
    }

    const btnAccept=document.getElementById('btnAccept')
    const btnReject=document.getElementById('btnReject')
    const resultBox=document.getElementById('resultBox')
    const resultText=document.getElementById('resultText')
    const heart=document.getElementById('heart')
    const replyArea=document.getElementById('replyArea')
    const sendReply=document.getElementById('sendReply')
    const cancelReply=document.getElementById('cancelReply')
    const replyText=document.getElementById('replyText')
    const shareWhatsapp=document.getElementById('shareWhatsapp')

    function showResult(text,showHeart=false,showReply=false){
      resultText.innerHTML=text
      resultBox.style.display='block'
      resultBox.setAttribute('aria-hidden','false')
      if(showHeart){setTimeout(()=>heart.classList.add('show'),80)}else{heart.classList.remove('show')}
      replyArea.style.display=showReply?'block':'none'
    }

    btnAccept.addEventListener('click',()=>{
      const text='<strong>Kayy memilih: TERIMA üíï</strong><p>\"Makasih, Epen. Aku akan coba memberikan kesempatan dan kita lihat perlahan. Terima kasih sudah jujur.\"</p>'
      showResult(text,true,true)
      saveOutcome('TERIMA','Penerima menerima.')
    })

    btnReject.addEventListener('click',()=>{
      const text='<strong>Kayy memilih: TOLAK ü§ç</strong><p>\"Maaf Epen, aku belum bisa. Tapi terima kasih sudah berani jujur. Semoga kamu cepat menemukan yang terbaik ya.\"</p>'
      showResult(text,false,true)
      saveOutcome('TOLAK','Penerima menolak.')
    })

    function saveOutcome(status,note){
      const time=new Date().toISOString()
      const payload={status,note,time}
      try{localStorage.setItem('surat_kayy_response',JSON.stringify(payload))}catch(e){console.warn('LocalStorage error',e)}
    }

    sendReply.addEventListener('click',()=>{
      const reply=replyText.value.trim()
      if(reply.length===0){alert('Isi jawaban kosong. Jika ingin kosong, tekan BATAL.');return}
      const stored=JSON.parse(localStorage.getItem('surat_kayy_response')||'{}')
      stored.reply=reply
      stored.replyTime=new Date().toISOString()
      localStorage.setItem('surat_kayy_response',JSON.stringify(stored))
      alert('Jawaban disimpan. Kamu bisa menyalin atau menunjukkan ini ke Epen.')
      replyText.value=''
    })

    cancelReply.addEventListener('click',()=>{
      if(confirm('Batalkan menulis jawaban?')){replyText.value='';replyArea.style.display='none'}
    })

    shareWhatsapp.addEventListener('click',()=>{
      const reply=replyText.value.trim()
      if(reply.length===0){alert('Tuliskan jawaban dulu sebelum dibagikan.');return}
      const message=`Halo Epen, ini jawabanku: %0A%0A${encodeURIComponent(reply)}`
      const url=`https://wa.me/?text=${message}`
      window.open(url,'_blank')
    })

    window.addEventListener('DOMContentLoaded',()=>{
      const prev=localStorage.getItem('surat_kayy_response')
      if(prev){
        const data=JSON.parse(prev)
        let summary=`<p>Status sebelumnya: <strong>${data.status||'‚Äî'}</strong></p>`
        if(data.note)summary+=`<p>${data.note}</p>`
        if(data.reply)summary+=`<hr><p><strong>Jawaban tertulis:</strong><br>${escapeHtml(data.reply)}</p>`
        showResult(summary,data.status==='TERIMA',false)
      }
    })

    function escapeHtml(str){return str.replace(/[&<>\"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',"'":'&#39;'}[m]))}
  </script>
</body>
</html>
